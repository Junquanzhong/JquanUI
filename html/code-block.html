<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JquanUI 概述</title>
    <link rel="stylesheet" href="../css/JquanUI@3.0.css">
    <link rel="stylesheet" href="../css/Config.css">
    <link rel="stylesheet" href="../css/app.css">
    <link rel="stylesheet" href="../css/JquanUI-Theme@3.0.css">
</head>

<body>
    <div class="container">
        <ul class="breadcrumb breadcrumb-filled breadcrumb-arrow breadcrumb-with-icons">
            <li><a href="/"><i class="bx bx-home"></i>ESM</a></li>
            <li class="active">代码块</li>
        </ul>
        <div class="container py-3">    
            <div class="card">
                <div class="card-header">
                    <cite class="mt-3 mb-3">代码块</cite>
                </div>
                <div class="card-body">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-3xl font-bold mb-6 text-center">CAN 代码高亮组件演示</h1>
                        <p class="mb-8 text-center text-gray-400">这是一个响应式、可复制、带行号的代码高亮组件。</p>

                        <!-- HTML 示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">HTML</h2>
                            <pre class="border border-strong"><code class="code-block" data-language="html" data-show-lines="true"><div class="card shadow-md">
        <img src="image.jpg" alt="示例图片" class="w-full h-auto rounded-t">
        <div class="p-4">
            <h3 class="text-lg font-bold">卡片标题</h3>
            <p class="text-gray-600">这是一段描述文字。</p>
        </div>
    </div></code></pre>
                        </section>

                        <!-- JavaScript 示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">JavaScript</h2>
                            <pre class="border border-strong"><code class="code-block" data-language="javascript" data-show-lines="true">const fetchUserData = async (userId) => {
    try {
        const response = await fetch(`https://api.example.com/users/${userId}`);
        if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
        }
        const userData = await response.json();
        return userData;
    } catch (error) {
        console.error("无法获取用户数据:", error);
    }
    };

    // 使用示例
    fetchUserData(123).then(user =&gt; {
    if (user) {
        console.log(user.name);
    }
    });</code></pre>
                        </section>

                        <!-- CSS 示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">CSS</h2>
                            <pre class="border border-strong"><code class="code-block" data-language="css" data-show-lines="true">.button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 1rem;
    font-size: 1rem;
    font-weight: 500;
    color: #ffffff;
    background-color: #3b82f6;
    border: none;
    border-radius: 0.375rem;
    cursor: pointer;
    transition: background-color 150ms ease-in-out;
    }

    .button:hover {
    background-color: #2563eb;
    }

    .button:focus {
    outline: 2px solid #60a5fa;
    outline-offset: 2px;
    }</code></pre>
                        </section>

                        <!-- Python 示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">Python</h2>
                            <pre class="border border-strong"><code class="code-block" data-language="python" data-show-lines="true">import requests
    from bs4 import BeautifulSoup

    def get_wikipedia_summary(title):
        """
        获取 Wikipedia 页面的摘要。
        """
        url = f"https://en.wikipedia.org/api/rest_v1/page/summary/{title}"
        try:
            response = requests.get(url, timeout=10)
            response.raise_for_status() # 如果状态码不是 200，则抛出异常
            data = response.json()
            return data.get('extract', '未找到摘要。')
        except requests.exceptions.RequestException as e:
            return f"请求失败: {e}"

    # 示例
    summary = get_wikipedia_summary("Python_(programming_language)")
    print(summary)</code></pre>
                        </section>

                        <!-- VBA 示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">VBA (Visual Basic for Applications)</h2>
                            <pre class="border border-strong"><code class="code-block" data-language="vba" data-show-lines="true">Sub ProcessWorksheetData()
        Dim ws As Worksheet
        Dim lastRow As Long
        Dim i As Long
        Dim cellValue As Variant
        
        ' 设置要操作的工作表
        Set ws = ThisWorkbook.Sheets("数据")
        
        ' 找到最后一行
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        
        ' 循环处理每一行
        For i = 2 To lastRow ' 假设第一行是标题
            cellValue = ws.Cells(i, 1).Value
            
            ' 条件判断
            If IsNumeric(cellValue) And cellValue > 100 Then
                ' 如果大于100，将相邻单元格标记为"高"
                ws.Cells(i, 2).Value = "高"
                ws.Cells(i, 2).Interior.Color = RGB(255, 199, 206) ' 浅红色背景
            Else
                ' 否则标记为"正常"
                ws.Cells(i, 2).Value = "正常"
            End If
        Next i
        
        MsgBox "数据处理完成！", vbInformation
    End Sub</code></pre>
                        </section>

                        <!-- 一个不带行号的示例 -->
                        <section class="mb-8">
                            <h2 class="text-xl font-semibold mb-2">不显示行号的示例</h2>
                            <pre class="border border-strong px-3"><code class="code-block" data-language="javascript">console.log("Hello, CAN! 这个代码块没有行号。");</code></pre>
                        </section>

                    </div>

                    <!--
        =============================================================================
        脚本部分
        =============================================================================
        -->
                    <!-- 3. 引入你的依赖模块 (请根据你的实际路径调整) -->
                    <!-- 我假设 copy.mjs 和 msg.mjs 与 code-highlighter.mjs 在同一目录 -->
                    <!-- <script type="module" src="./msg.mjs"></script>  -->
                    <!-- <script type="module" src="./copy.mjs"></script> -->
                    <!-- 请取消上面两行的注释，如果它们是独立模块 -->

                    <!-- 4. 初始化代码高亮组件 -->
                    <script type="module">
                        import { initCodeHighlighter } from '../js/modules/code-block.mjs';
                        // 调用初始化函数
                        // 这里可以覆盖默认配置
                        initCodeHighlighter({
                            copyButtonText: 'Copy',
                            copiedButtonText: 'Copied!',
                            copiedTextDuration: 3000, // 3秒
                            showLinesByDefault: false // 不显示行号
                            // showLinesByDefault 保持 true，因为我们大部分都需要
                        });
                    </script>
                </div>
            </div>
        </div>
        <div class="container py-3">    
            <div class="card">
                <div class="card-header">
                    <cite class="mt-3 mb-3">全局配置参数</cite>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>参数名</th>
                                <th>类型</th>
                                <th>默认值</th>
                                <th>解释</th>
                                <th>用法示例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>codeBlockSelector</code></td>
                                <td><code>string</code></td>
                                <td><code>'pre code.code-block'</code></td>
                                <td>一个 CSS 选择器，用来指定页面中哪些代码块需要被处理。</td>
                                <td>
                                    <pre><code>initCodeHighlighter({
    codeBlockSelector: '.my-custom-code'
    });</code></pre>
                                </td>
                            </tr>
                            <tr>
                                <td><code>showLinesByDefault</code></td>
                                <td><code>boolean</code></td>
                                <td><code>true</code></td>
                                <td>是否默认为所有代码块显示行号。</td>
                                <td>
                                    <pre><code>initCodeHighlighter({
    showLinesByDefault: false
    });</code></pre>
                                </td>
                            </tr>
                            <tr>
                                <td><code>copyButtonText</code></td>
                                <td><code>string</code></td>
                                <td><code>'复制'</code></td>
                                <td>复制按钮上显示的初始文本。</td>
                                <td>
                                    <pre><code>initCodeHighlighter({
    copyButtonText: 'Copy'
    });</code></pre>
                                </td>
                            </tr>
                            <tr>
                                <td><code>copiedButtonText</code></td>
                                <td><code>string</code></td>
                                <td><code>'已复制!'</code></td>
                                <td>点击复制后，按钮上临时显示的成功提示文本。</td>
                                <td>
                                    <pre><code>initCodeHighlighter({
    copiedButtonText: 'Copied!'
    });</code></pre>
                                </td>
                            </tr>
                            <tr>
                                <td><code>copiedTextDuration</code></td>
                                <td><code>number</code></td>
                                <td><code>2000</code></td>
                                <td>点击复制后，成功提示文本显示的持续时间（单位：毫秒）。</td>
                                <td>
                                    <pre><code>initCodeHighlighter({
    copiedTextDuration: 3000
    });</code></pre>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="container py-3">    
            <div class="card">
                <div class="card-header">
                    <cite class="mt-3 mb-3">单块配置参数 (HTML <code>data-*</code> 属性)</cite>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>属性名</th>
                                <th>类型</th>
                                <th>默认值</th>
                                <th>解释</th>
                                <th>用法示例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>data-language</code></td>
                                <td><code>string</code></td>
                                <td><code>'plaintext'</code></td>
                                <td>指定代码块的语言。这对于语法高亮至关重要。</td>
                                <td>
                                    <pre><code>&lt;code data-language="python"&gt;...&lt;/code&gt;</code></pre>
                                </td>
                            </tr>
                            <tr>
                                <td><code>data-show-lines</code></td>
                                <td><code>string</code> ('true' / 'false')</td>
                                <td>继承全局配置</td>
                                <td>强制为当前代码块开启或关闭行号显示。</td>
                                <td>
                                    <pre><code>&lt;code data-show-lines="false"&gt;...&lt;/code&gt;</code></pre>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/apps/app.js" type="module"></script>
</body>

</html>