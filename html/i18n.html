<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JquanUI æ¦‚è¿°</title>
    <link rel="stylesheet" href="../css/JquanUI@3.0.css">
    <link rel="stylesheet" href="../css/app.css">
    <style>
        /* å½“æŒ‰é’®æ‹¥æœ‰ active ç±»æ—¶åº”ç”¨çš„æ ·å¼ */
        .lang-btn.active {
            background-color: #4f46e5;
            /* primary color */
            color: white;
            border-color: #4f46e5;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.4);
        }

        /* ç®€å•çš„è¿‡æ¸¡åŠ¨ç”» */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <ul class="breadcrumb breadcrumb-filled breadcrumb-arrow breadcrumb-with-icons">
            <li><a href="/"><i class="bx bx-home"></i>ESM</a></li>
            <li class="active">I18n</li>
        </ul>
        <div class="container py-3">
            <!-- é¡¶éƒ¨å¯¼èˆªæ  (Glassmorphism) -->
            <nav class="w-full bg-white backdrop-blur-md border-b border-slate-200 shadow-sm transition-all">
                <div class="max-w-5xl mx-auto px-8">
                    <div class="flex justify-between items-center h-16">
                        <!-- Logo / Title -->
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg">
                                I
                            </div>
                            <span class="font-bold text-xl tracking-tight text-slate-900"
                                data-i18n-key="app.title">Ultimate I18n</span>
                        </div>

                        <!-- è¯­è¨€åˆ‡æ¢å™¨ -->
                        <div class="flex items-center space-x-2 bg-slate-100 p-1 rounded-lg">
                            <button
                                class="lang-btn px-4 py-1.5 text-sm font-medium rounded-md text-slate-600 hover-text-primary transition-all duration-200 focus-outline-none"
                                data-i18n-switcher="en">
                                English
                            </button>
                            <button
                                class="lang-btn px-4 py-1.5 text-sm font-medium rounded-md text-slate-600 hover-text-primary transition-all duration-200 focus-outline-none"
                                data-i18n-switcher="zh">
                                ä¸­æ–‡
                            </button>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- ä¸»ä½“å†…å®¹ -->
            <main class="flex-grow pt-28 pb-12 px-4 sm:px-6">
                <div class="max-w-4xl mx-auto">

                    <!-- Hero Header -->
                    <div class="text-center mb-12 fade-in">
                        <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 bg-clip-text text-gradient bg-gradient-to-r from-primary to-secondary"
                            data-i18n-key="app.title">
                            Ultimate I18n Demo
                        </h1>
                        <p class="text-lg text-slate-500 max-w-2xl mx-auto" data-i18n-key="app.subtitle">
                            Production grade internationalization solution
                        </p>
                    </div>

                    <!-- Grid å¸ƒå±€ -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

                        <!-- å¡ç‰‡ 1: è¡¨å•ä¸å±æ€§ç¿»è¯‘ -->
                        <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100 p-6 hover:shadow-2xl transition-shadow duration-300 fade-in"
                            style="animation-delay: 0.1s;">
                            <div class="flex items-center gap-3 mb-6">
                                <div class="p-2 bg-blue-100 text-blue-600 rounded-lg">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                                        </path>
                                    </svg>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800" data-i18n-key="form.title">Attributes & Forms</h3>
                            </div>

                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1"
                                        data-i18n-key="form.label">Username</label>
                                    <!-- å±æ€§ç¿»è¯‘æ¼”ç¤º -->
                                    <input type="text"
                                        class="w-full px-4 py-2 border border-slate-300 rounded-lg focus-ring-2 focus-ring-primary focus-border-primary outline-none transition-all text-sm"
                                        data-i18n-attr="placeholder:form.placeholder; title:form.label">
                                </div>
                                <button
                                    class="w-full bg-slate-900 text-white font-medium py-2.5 rounded-lg hover-bg-slate-800 focus-ring-4 focus-ring-slate-200 transition-all transform active-scale-95"
                                    data-i18n-key="form.submit">
                                    Sign In
                                </button>
                            </div>
                        </div>

                        <!-- å¡ç‰‡ 2: å˜é‡ä¸å¤æ•° -->
                        <div class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100 p-6 hover:shadow-2xl transition-shadow duration-300 fade-in"
                            style="animation-delay: 0.2s;">
                            <div class="flex items-center gap-3 mb-6">
                                <div class="p-2 bg-green-100 text-green-600 rounded-lg">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
                                    </svg>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800" data-i18n-key="msg.title">Variables & Pluralization</h3>
                            </div>

                            <div class="space-y-4">
                                <div class="p-3 bg-slate-50 rounded-lg border border-slate-100">
                                    <span
                                        class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-200 text-gray-800 mb-1">Static
                                        Key</span>
                                    <p class="text-slate-700 font-medium" data-i18n-key="msg.welcome"
                                        data-i18n-params='{"name": "Jquan"}'>...</p>
                                </div>

                                <div class="flex gap-4">
                                    <div class="flex-1 p-3 bg-slate-50 rounded-lg border border-slate-100">
                                        <span
                                            class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800 mb-1">Count:
                                            1</span>
                                        <p class="text-slate-700" id="plural-one">...</p>
                                    </div>
                                    <div class="flex-1 p-3 bg-slate-50 rounded-lg border border-slate-100">
                                        <span
                                            class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800 mb-1">Count:
                                            5</span>
                                        <p class="text-slate-700" id="plural-other">...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å¡ç‰‡ 3: åŠ¨æ€ DOM ç›‘å¬ (MutationObserver) -->
                        <div class="md:col-span-2 bg-gradient-to-br from-indigo-50 to-white rounded-2xl shadow-xl shadow-slate-200/50 border border-indigo-100 p-6 fade-in"
                            style="animation-delay: 0.3s;">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    <div class="p-2 bg-primary text-white rounded-lg shadow-lg shadow-indigo-300">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-slate-800" data-i18n-key="dynamic.title">...</h3>
                                        <p class="text-sm text-slate-500" data-i18n-key="dynamic.desc">...</p>
                                    </div>
                                </div>
                                <button id="add-btn"
                                    class="bg-white text-primary border border-indigo-200 hover-bg-indigo-50 font-semibold py-2 px-4 rounded-lg shadow-sm transition-all flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    <span data-i18n-key="dynamic.btn">Add Element</span>
                                </button>
                            </div>

                            <!-- åŠ¨æ€å†…å®¹å®¹å™¨ -->
                            <div id="dynamic-container"
                                class="grid grid-cols-3 gap-3 min-h-[60px] p-4 border-2 border-dashed border-indigo-200 rounded-xl bg-white">
                                <!-- JS å°†ä¼šåœ¨è¿™é‡Œæ’å…¥å…ƒç´  -->
                            </div>
                        </div>

                    </div>
                </div>
            </main>
        </div>
        <div class="container my-3">
            <div class="card">
                <div class="card-header">
                    <cite class="mt-3 mb-3">é…ç½®ç¤ºä¾‹</cite>
                </div>
                <div class="card-body">
                    <pre>
                        <code data-language="js">
                            import { initI18n, t, setLanguage } from "../js/modules/i18n.mjs";
                            initI18n({
                                storageKey: "language",  // å­˜å‚¨è¯­è¨€çš„ localStorage é”®å
                                urlParamKey: "lg",  // URL å‚æ•°é”®åï¼Œç”¨äºæŒ‡å®šè¯­è¨€
                                debug: true, // é»˜è®¤å¼€å¯è°ƒè¯•ï¼Œæ–¹ä¾¿æ’æŸ¥
                                mode: "json",  // ç¿»è¯‘æ¨¡å¼ï¼šjson æˆ– tag
                                languages: ["en", "zh"],  // æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
                                defaultLanguage: "en",  // é»˜è®¤è¯­è¨€
                                localesPath: "../locales",  // ç¿»è¯‘æ–‡ä»¶æ‰€åœ¨ç›®å½•
                                autoObserve: true,  // æ˜¯å¦è‡ªåŠ¨ç›‘å¬ localStorage å˜åŒ–
                            })
                        </code>
                    </pre>
                </div>
            </div>
        </div>
        <div class="container my-3">
            <div class="card">
                <div class="card-header">
                    <cite class="mt-3 mb-3">é…ç½®å‚æ•° (Data Attributes)</cite>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>å±æ€§å</th>
                                <th>å€¼ / ç±»å‹</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>storageKey</td>
                                <td>string</td>
                                <td>å­˜å‚¨è¯­è¨€çš„ localStorage é”®å</td>
                            </tr>
                            <tr>
                                <td>urlParamKey</td>
                                <td>string</td>
                                <td>URL å‚æ•°é”®åï¼Œç”¨äºæŒ‡å®šè¯­è¨€</td>
                            </tr>
                            <tr>
                                <td>debug</td>
                                <td>boolean</td>
                                <td>æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œé»˜è®¤ false</td>
                            </tr>
                            <tr>
                                <td>mode</td>
                                <td>string</td>
                                <td>ç¿»è¯‘æ¨¡å¼ï¼šjson æˆ– tagï¼Œé»˜è®¤ json</td>
                            </tr>
                            <tr>
                                <td>languages</td>
                                <td>array</td>
                                <td>æ”¯æŒçš„è¯­è¨€åˆ—è¡¨</td>
                            </tr>
                            <tr>
                                <td>defaultLanguage</td>
                                <td>string</td>
                                <td>é»˜è®¤è¯­è¨€ï¼Œé»˜è®¤ en</td>
                            </tr>
                            <tr>
                                <td>localesPath</td>
                                <td>string</td>
                                <td>(jsonæ—¶)ç¿»è¯‘æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œé»˜è®¤ ../locales</td>
                            </tr>
                            <tr>
                                <td>autoObserve</td>
                                <td>boolean</td>
                                <td>æ˜¯å¦è‡ªåŠ¨ç›‘å¬ localStorage å˜åŒ–ï¼Œé»˜è®¤ true</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script type="module">
        import { initI18n, t, setLanguage } from "../js/modules/i18n.mjs";
        import { initCodeHighlighter } from '../js/modules/code-block.mjs';
        import { init } from '../js/modules/jit-engine.mjs';
        // åˆå§‹åŒ– JIT å¼•æ“
        init({});
        // è°ƒç”¨åˆå§‹åŒ–å‡½æ•°
        // è¿™é‡Œå¯ä»¥è¦†ç›–é»˜è®¤é…ç½®
        initCodeHighlighter({
            showLineNumbers: true, // æ˜¾ç¤ºè¡Œå·
            langLabel: true,  // æ˜¯å¦æ˜¾ç¤ºè¯­è¨€æ ‡ç­¾
        });
        // 1. åˆå§‹åŒ–
        initI18n({
            languages: ["en", "zh"],
            defaultLanguage: "en",
            debug: true,
        }).then(() => {
            console.log("ğŸ‰ I18n Ready!");
            renderJsContent();
        });
        window.addEventListener("languageChanged", (e) => {
            console.log("Language changed event received:", e.detail.language);
            renderJsContent();
        });
        // ç»‘å®šè¯­è¨€åˆ‡æ¢æŒ‰é’®
        document.querySelectorAll("[data-i18n-switcher]").forEach((btn) => {
            btn.addEventListener("click", () => {
                const lang = btn.getAttribute("data-i18n-switcher");
                setLanguage(lang);
            });
        });
        function renderJsContent() {
            const elOne = document.getElementById("plural-one");
            const elOther = document.getElementById("plural-other");
            if (elOne) elOne.textContent = t("msg.apples", { count: 1 });
            if (elOther) elOther.textContent = t("msg.apples", { count: 5 });
        }
        // --- åŠ¨æ€æ·»åŠ å…ƒç´ é€»è¾‘ (é€‚é… Tailwind) ---
        const addBtn = document.getElementById("add-btn");
        const container = document.getElementById("dynamic-container");
        if (addBtn) {
            addBtn.addEventListener("click", () => {
                // åˆ›å»ºå…ƒç´ 
                const newDiv = document.createElement("div");

                // æ·»åŠ  Tailwind ç±»åï¼Œä½¿å…¶ç¾è§‚
                newDiv.className = "p-3 bg-white border border-indigo-100 rounded-lg shadow-sm text-indigo-700 text-sm font-medium animate-pulse flex items-center gap-2";

                // æ·»åŠ ä¸€ä¸ªå°å›¾æ ‡
                const icon = document.createElement("span");
                icon.innerHTML = "âœ¨";
                newDiv.appendChild(icon);

                // åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹å®¹å™¨
                const textSpan = document.createElement("span");
                // è®¾ç½® i18n key
                textSpan.setAttribute("data-i18n-key", "dynamic.added");
                // åˆå§‹è®¾ç½®å†…å®¹ï¼ˆé˜²æ­¢é—ªçƒï¼Œè™½ç„¶ observer å¾ˆå¿«ï¼‰
                textSpan.textContent = "Loading...";

                newDiv.appendChild(textSpan);
                container.appendChild(newDiv);

                // ç§»é™¤ pulse åŠ¨ç”»æ•ˆæœï¼Œæå‡ä½“éªŒ
                setTimeout(() => {
                    newDiv.classList.remove("animate-pulse");
                }, 500);
            });
        }
    </script>
    <script src="../js/apps/app.js" type="module"></script>
</body>

</html>